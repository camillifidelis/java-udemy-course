import java.util.*;
import java.util.concurrent.*;

public class Program {

    private static final ExecutorService executor = Executors.newFixedThreadPool(2);
    private static final Map<String, Integer> mapa = Collections.unmodifiableMap(new HashMap<>());

    public static void main(String[] args) {

        String texto = null;
        if (texto.equals("teste")) {
            System.out.println("Nunca chega aqui");
        }


        List<String> lista = new ArrayList<>(Arrays.asList("A", "B", "C"));
        for (String s : lista) {
            if (s.equals("B")) {
                lista.remove(s);
            }
        }

        // 3. UnsupportedOperationException (mapa imutável)
        mapa.put("chave", 123);

        // 4. ClassCastException sutil
        Object valor = "123";
        Integer numero = (Integer) valor;

        // 5. Future que nunca termina (deadlock disfarçado)
        Future<String> futuro = executor.submit(() -> {
            Thread.sleep(2000);
            return "ok";
        });
        futuro.get(1, java.util.concurrent.TimeUnit.MILLISECONDS);

        // 6. ArrayIndexOutOfBounds não óbvio
        int[] numeros = new int[5];
        for (int i = 0; i <= numeros.length; i++) {
            numeros[i] = i;
        }

        // 7. ArithmeticException mascarada
        int divisor = Integer.parseInt("0");
        int resultado = 100 / divisor;
        System.out.println(resultado);

        // 8. IllegalStateException com stream
        Stream<String> stream = Stream.of("X", "Y", "Z");
        stream.forEach(System.out::println);
        stream.count();

        // 9. Erro de concorrência com recurso fechado
        executor.shutdown();
        executor.submit(() -> System.out.println("Isso falha"));

        // 10. StackOverflowError
        recursaoInfinita();
    }

    private static void recursaoInfinita() {
        recursaoInfinita();
    }
}
